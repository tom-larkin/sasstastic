<?php
	if ( !defined('ABSPATH') ){ die(); }
	
	global $avia_config, $more;

	/*
	 * get_header is a basic wordpress function, used to retrieve the header.php file in your theme directory.
	 */
	 get_header();
	
		
		$showheader = true;
		if(avia_get_option('frontpage') && $blogpage_id = avia_get_option('blogpage'))
		{
			if(get_post_meta($blogpage_id, 'header', true) == 'no') $showheader = false;
		}
		
	 	if($showheader)
	 	{
			echo avia_title(array('title' => avia_which_archive()));
		}
		
		do_action( 'ava_after_main_title' );

		
	?>

		<div class='container_wrap container_wrap_first main_color <?php avia_layout_class( 'main' ); ?>'>
		    


			<div class='container template-blog '>

				<main class='content <?php avia_layout_class( 'content' ); ?> units' <?php avia_markup_helper(array('context' => 'content','post_type'=>'post'));?>>
				   <div class="archive_top">
				   <h1 class="archive_heading">Locally Grown Organic Produce</h1>

<p class="archive_description">At Squarefoot Gardens, we pride ourselves in having the freshest, most flavorful, and most importantly most healthy produce available for our loyal customers. </p>


</div>
<br>

<form action="<?php echo site_url() ?>/wp-admin/admin-ajax.php" method="POST" id="filter">
	<?php
		if( $terms = get_terms( array( 'taxonomy' => 'vegetable_type', 'orderby' => 'name' ) ) ) : 
			echo '<div id=ck-button>';
			echo '<select name="categoryfilter" ><option value="">Select category...</option>';
			foreach ( $terms as $term ) :
				echo '<option value="' . $term->term_id . '">' . $term->name . '</option>'; // ID of the category as the value of an option
			endforeach;
			echo '</select>';
			echo '</div>';
		endif;

		if( $vegetable_types = get_terms( array( 'taxonomy' => 'vegetable_type' ) ) ) :
			foreach( $vegetable_types as $vegetable_type ) :
				

				$color = get_field('veg_type_color', $vegetable_type);
				
				echo '<p class="veg-type-select" style="color:'. $color .' !important"><input class="veg-type-select" type="checkbox" id="yourself"' . $vegetable_type->term_id . '" name="region_' . $vegetable_type->term_id . '" /><label for="region_' . $vegetable_type->term_id . '">' . $vegetable_type->name . '</label></p>';
			endforeach;
		
		endif;
	?>
	<label>
		<input type="checkbox" name="in_stock" /> In Stock
	</label>
	
	<button>Apply filter</button>
	<input type="hidden" name="action" value="myfilter">
</form>

<script>
jQuery(function($){

	$('#filter').submit(function(){
		$('#yourselect').click(function(){
    // AJAX reque
})
		var filter = $('#filter');
		$.ajax({
			url:filter.attr('action'),
			data:filter.serialize(), // form data
			type:filter.attr('method'), // POST
			beforeSend:function(xhr){
				filter.find('button').text('Searching...'); // changing the button label
			},
			success:function(data){
				filter.find('button').text('Apply filter'); // changing the button label back
				$('#response').html(data); // insert data
			}
		});
		return false;
	});
});
</script>

<?


?>



<div class="responsive-gallery" id="response" >



<ul id="myList" class="term_glossary">

 	
	
				<?php
				if ( have_posts() ) :
				 while ( have_posts() ) : the_post(); ?>

				<?php 
				if( get_the_post_thumbnail_url('') ){
				$img = get_the_post_thumbnail_url('');
		
				} else {
	   			$img = ('https://sqft.specialops.io/wp-content/uploads/no-image-uploaded-1.jpg');
				}?>

				<?php 
$terms = wp_get_post_terms(get_the_id(), 'vegetable_type', array('fields' => 'ids'));
	$color = get_field('veg_type_color', 'vegetable_type_'.$terms[0]); ?>

				  <li>
				  
				  <div class="img-wrap third"><a class="veg-archive-name-link" href="<? echo the_permalink();?>"><? echo the_title();?></a><a class="veg-archive-image-link" href="<? echo the_permalink();?>">
				  <img src="<?php echo $img;?>" caption="<? echo the_title();?>" class="veg-archive-image" style="z-index:-1; border: 4px solid <? echo $color; ?> !important;"></a>

				</div>
			</li>
				 
                    <?php endwhile;
                    endif;
                    
                ?>

</ul>   
</div>

				<!--end content-->
				</main>

				<?php

				//get the sidebar
                if (avia_get_option('archive_sidebar') == 'archive_sidebar_separate') {
                    $avia_config['currently_viewing'] = 'archive';
                }
                else {
                    $avia_config['currently_viewing'] = 'blog';
                }
				get_sidebar();

				?>
	 

			</div><!--end container-->


		</div><!-- close default .container_wrap element -->

		



<?php 
		get_footer();


		